the bitcoin backbone protocol against quantum adversaries alexandru cojocaru? juan garay?? aggelos kiayias? fang song+ petros wallden++ abstract. bitcoin and its underlying blockchain protocol have received recently significant attention the context building distributed systems well from the perspective the foundations the consensus problem. the same time, the rapid development quantum technologies brings the possibility quantum computing devices from theoretical concept emerging technology. motivated this, this work revisit the formal security the core the bitcoin protocol, called the bitcoin backbone, under the assumption that the adversary has access scalable quantum computer. prove that the protocol's essential properties stand the post-quantum setting assuming suitably bounded quantum adversary the quantum random oracle (qro) model. specifically, our results imply that security can shown bounding the quantum queries that each quantum query worth o(p-/ classical ones and that the wait time for safe settlement expanded multiplicative factor o(p-/ where the probability success single classical query the protocol's underlying hash function. introduction bitcoin and its underlying blockchain protocol structure have received substantial attention recent years both due its potential for various applications well due the possibility using solve fundamental distributed computing questions alternative and novel threat models. [], abstraction bitcoin's underlying protocol, termed the "bitcoin backbone" was presented and analyzed assuming fixed (albeit unknown) number parties ("miners"), fraction which may behave arbitrarily controlled adversary. this was followed who further refined the model and its security analysis. high level, the protocol relies concept known proof work (pow) [], which, intuitively, enables party convince others that has invested some effort for solving task--specifically, finding value ("witness") such that hash function (sha-) applied that value together with (the hash of) the last block and new transactions yields output that less than ??? university edinburgh. a.d.cojocaru@sms.ed.ac.uk texas a&m university. garay@cse.tamu.edu university edinburgh and iohk. akiayias@inf.ed.ac.uk texas a&m university. fang.song@tamu.edu university edinburgh. petros.wallden@ed.ac.uk certain target value. party that successful producing pow gets add new block the blockchain (and rewarded). the abstraction, the hash function modelled random oracle (ro) [], and assumes uniform configuration, meaning that parties are endowed with the same computational power, measured the allowed number queries the per round. number desired properties for the blockchain thus constructed--namely, common prefix and chain quality --were introduced and shown sufficient for the realization applications, notably robust public transaction ledger (a.k.a. "nakamoto consensus"), assuming honest majority computational power (or equivalently, the uniform configuration setting mentioned above, that the number honest parties exceed the number malicious ones). the model well that all subsequent papers follows and such parties are "classical" and modelled polynomially bounded interactive turing machines (itms), and protocol properties such the ones above can expressed predicates over random variables quantifying over all possible adversaries. summary, the above works put forth elegant modeling and analyses and constitute important step forward our understanding the capabilities this emerging technology, but quantum computing, which equips attackers with unprecedented power and changing the landscape cryptography, "is coming" with the known devastating consequences: shor's quantum algorithm solves factorization and discrete logarithm efficiently, and hence breaks popular publickey cryptosystems based them. the mere capability collecting side information quantum register sometimes compromises information-theoretically secure schemes, such randomness extractors for privacy amplification []. fact, the unique features quantum information, such intrinsic randomness and no-cloning, render many classical security analysis obsolete (e.g., rewinding ]), and even the right modeling security the presence quantum attacks can elusive core ingredient the bitcoin blockchain proofs work (pow) [], and the dynamic construction blockchain can seen sequential compositions it. the analysis relies critically generic properties cryptographic hash functions, modeled random oracle (ro) and only given oracle access. when quantum attackers are present, boneh al. argued the need for granting the attackers querying the random oracle quantum-superposition, which gives the quantum random oracle (qro) model. quantum superposition attacks also turn out devastating, even symmetric-key cryptosystems which are usually considered less vulnerable quantum attacks (for example, several practical authentication schemes using block ciphers are broken this strong attack model ]). roughly speaking, the pow used blockchain protocols corresponds solving some search problem making quantum-superposition queries (random) hash function, which first sight reminiscent some standard problems studied quantum query complexity. however, existing results and techniques for proving quantum query lower bounds not immediately translate the cryptographic setting. this because cryptography are interested average-case complexity opposed the typical worst-case complexity; also, standard quantum query lower bounds usually apply quantum algorithms with high success probability only, whereas attacker with small but noticeable chance breaking scheme still relevant. fact, attacker may take advantage some complicated composition pows, and result its query complexity seems require considerable extension known techniques (such composition theorems for quantum query complexity []). important first step understanding bitcoin's vulnerabilities against quantum attacks, aggarwal al. investigated the quantum threats bitcoin, taking into account detailed resource estimations (e.g., quantum error correction) and the prospect the physical implementation quantum computers. they asserted that the elliptic-curve-based signature scheme used bitcoin would completely broken quantum computer early and hence switching post-quantum signatures critical. the other hand, they observed that the stand-alone search problem induced pow relatively resistant near-term quantum computations due their slow clock speed and large overhead quantum error correction. however, the security implications for the bitcoin backbone are still not clear. given the complex workings blockchain, quantum attackers could employ sophisticated strategies beyond solving the stand-alone search problem. thus, comprehensive analysis the security pow-based blockchain against quantum attacks remains pressing issue. our contributions. this paper analyze the bitcoin backbone protocol under the assumption that the adversary has access devices able perform universal quantum computing. mentioned above, the two main properties that are required are common prefix (honest parties always agree truncated local chains) and chain quality (expressing the ratio honest/adversarial blocks and guaranteeing that least certain fraction the blocks are generated honest parties). result our analysis, are able ensure that the common prefix and chain quality properties can still satisfied against quantum attackers, provided some bounds the quantum computational hashing power hold. the "honest majority" condition get that the total number quantum queries the attacker has less than the total number classical queries all the honest parties divided extra o(p-/ factor, where the probability success single query and, informally, represents the difficulty level the pow. this extra factor the main difference from the classical analysis and due the quadratic quantum speed-up (generalized) search algorithms. moreover, the common prefix and chain quality properties hold except with negligible probability, and this negligible probability achieved after number rounds our analysis indicates that achieve the same negligible probability against quantum attacker, the new required number rounds the same with the classical multiplied extra o(p-/ factor. this has necessary (and sufficient) for the properties satisfied []'s uniform configuration with respect hashing power. the implication that the number "block confirmations" necessary for transaction accepted has increased accordingly for post-quantum security order protect against double-spending based our results. having proven that the common prefix and chain quality properties hold against quantum attackers, can build applications (such consensus [a.k.a. byzantine agreement []] and public transaction ledger [i.e., bitcoin]) exactly shown []. now, these applications require digital signatures and well known that quantum attacker can compromise some the digital signature schemes (including ecdsa, used bitcoin). therefore, order for our analysis the bitcoin backbone protocol carry over the above applications need ensure that post-quantum secure digital signature scheme used (see also where different post-quantum signature schemes were compared for their suitability for bitcoin). summarize, our contributions are follows: model the quantum attackers the context the backbone protocol. extract from sufficient conditions imposed the number pows adversary can solve within rounds order for the common prefix and chain quality properties hold. using our model are able obtain bounds the expected number pows within rounds that any quantum adversary can achieve. this then used get "honest majority" condition. derive new concentration theorems (extending chernoff bound and proving generalised version azuma's inequality). these results are independent interest. finally, using (old and new) concentration results applied our model for quantum attackers, complete the analysis the bitcoin backbone protocol giving tight characterization the overwhelming probabilities that the properties hold with. overview our results. our setting (see section for more details) model the computational power honest parties number queries per party random oracle (ro). the classical setting, the adversary assumed benefit from the joint computational effort the parties under his control. accordingly, and simplify the analysis assume that there single quantum adversary with total computational power queries per round--to quantum random oracle (qro) []. section extract from the original reference the quantities and constraints, between variables the honest parties and adversaries, that are sufficient ensure the common prefix and chain quality properties. since assume that honest parties not have quantum computing power, all the analysis involving the variables honest parties remains unchanged from []. thus, the main quantity interest the variables the adversaries, i.e, the number blocks that the quantum adversary can achieve within certain number rounds. solving pow modeled quantum search problem, where the role the grover oracle played the qro. other words, the adversary prepares equal superposition and then using the qro and quantum-search type algorithm, amplifies the probability finding pow. actually solve one such pow, the adversary needs perform measurement, and doing this either solves the pow has now destroyed the amplification the probability and needs start from scratch. the probability succeeding such process bounded known bounds quantum search algorithms. importantly, the quantum adversary allowed use the quantum queries round trying solve specific pow but instead measuring the end the round can carry over the output quantum state the next round and continue trying solve the same problem. this not the same transferring his quantum queries the next round, since the problem (and instance the qro) trying solve was defined the first round. the other hand, the fact that the adversary receives the next round state that somehow has information about the problem one tries solve, differs from the classical case, where each query (and thus different rounds) completely independent from the previous. unlike the classical case, where one can perform one query after another and every time check the query solved pow, get grover-type speedup the quantum adversary needs apply the qro queries top previous queries without making measurement. therefore, the main free choice that the quantum adversary has, decide when each quantum measurement made. for each such measurement, the adversary can solve most single pow. divide the analysis perform into three steps, follows. honest majority. analyzing the maximum expected blocks that the quantum adversary can achieve, are able determine relation between the honest hashing power (classical queries per round) and the maximum adversarial quantum hashing power (quantum queries per round). akin the classical setting, this sets "honest majority" condition that essential for the protocol secure. concentration results. order see how quickly the desired properties are satisfied, top bounding the average number adversary's blocks, need also bound the tails the corresponding distribution. this will tell how long need wait (protocol rounds) know that the average advantage the honest parties translates actual longer chain with probability high requested the security level. bitcoin backbone properties. combining the results from for the honest parties with our results for the quantum adversary and using the new conditions derived section obtain the conditions and parameters under which the main backbone protocol properties hold. perform this analysis for the most general adversary our model first consider two restricted classes. the first class, that also physically motivated, the "noisy quantum storage" where the adversary while has quantum computer, the quantum memory the device imperfect (noisy) and therefore has make measurement the end the round, since cannot carry over the quantum state the next round. top the physical motivation, the techniques used prove the honest majority and concentration results are very similar with the ones used for stronger adversaries and thus instructive examine this early. the second class the "non-adaptive" where the adversary has quantum memory (can transfer quantum states from round round) but needs decide when will perform measurements independently the previous measurement outcomes. again the motivation for looking this class comes from the use the techniques (and some results) for the analysis the most general case. for each class through all the three steps given above. noisy quantum storage. the adversary gets quadratic speed-up per round len(c), prefix write the bitcoin backbone protocol executed arbitrary number parties over unauthenticated network, described above. assumed that the number parties running the protocol fixed however, parties need not aware this number when they execute the protocol. our analysis will have honest parties and single quantum adversary. also mentioned above, communication over the network achieved utilizing send-to-all diffuse functionality that available all parties (and may abused the adversary the sense delivering different messages different parties). each party maintains blockchain, defined above, starting from the empty chain and mining block that contains the value (by convention this the "genesis block"). given round, party successful generating pow (i.e., satisfying conjunction .), diffuses the network. each round, each party chooses the longest chain amongst the one has received, and tries extend computing (mining) another block. such process, each party's chain may different, but under certain well-defined conditions, shown that the chains honest parties will share large common prefix (see below). the backbone protocol, the type values that parties try insert the chain intentionally left unspecified, well the type chain validation they perform (beyond checking for its structural properties with respect the hash functions g(*), h(*)), and the way they interpret the chain. instead, these actions are abstracted the external functions (*) (the content validation predicate), i(*) (the input contribution function), and r(*) (the chain reading function), which are specified the application that runs "on top" the backbone protocol (e.g., transaction ledger). basic security properties the blockchain. shown that the blockchain data structure built the bitcoin backbone protocol satisfies number basic properties. high level, the first property, called common prefix, has with the existence, well persistence time, common prefix blocks among the chains honest parties. definition (common prefix). the common prefix property with parameter states that for any pair honest players adopting chains rounds pqn( pqn) which then give the following concentration results for the random variables x(s) and (s): lemma ([]). for any rounds, have that with probability e-( the following hold: )f for any consecutive rounds, against any quantum adversary the following condition holds: (s) consecutive blocks chain have been computed consecutive rounds. which following the proof contradiction lemma ([]), imposes the condition: for any quantum adversary and for any have: x(s) (s) len(c then and for and for the proof this lemma, what must guarantee that for any quantum adversary and for have: (s) sufficient impose the quantum adversary the following two conditions for any consecutive rounds: x(s) z(s) and ratio honest blocks where determined the condition: z(s) then this proves that for any corollary any consecutive blocks the chain honest party contain least one honest block. crucially, besides obtaining restrictions depending the type the adversary, must specify with what probability the common prefix property holds, which the reason seek the tightest concentration result possible. noisy quantum storage adversaries the noisy quantum storage model the adversary's quantum memory degrading time and after fixed amount time needs reset. this constrained model implies that the adversary cannot continue the grover iterations long wants, and instead forced make measurement the end each round. will denote this adversary anoisy maximum expectation noisy quantum storage strategies theorem for any noisy quantum storage adversary anoisy the maximum expected number pows, given any number rounds is: max e[zanoisy (s)] cpsq (.) proof. start with simplifying scenario, where assume that anoisy performs single measurement per round (at the end the round). using theorem the expected number adversarial blocks created any round (probability that the single pow solved) can bounded e[zanoisy can assume that the adversary, the first measurement, trying solve one particular pow (either extend previously generated adversarial chain, starting from one existing honest chain). successful, the second measurement tries build block solving new pow that extends the chain which block just generated. was unsuccessful, the adversary his second measurement, tries solve again the same problem. then, denote panoisy (i) the probability obtaining pows (out possible pows), the expected number adversarial blocks obtained anoisy any round can described as: e[zanoisy panoisy (i) i{,,...,q} |i|=i l{,*** ,q}-i (.) however, notice that zanoisy defined the number successes sequence independent measurements with outcome success failure, each the measurements having success probability pkq then zanoisy poisson binomial distribution. therefore, zanoisy poisson binomial distribution, its mean equal the sum the bernoulli distributions: e[zanoisy pki (.) then, need find the maximum e[zanoisy over all possible ..., subject the constraint each such that e[x] have: ( (.) r[x )m )b] (.) combining this concentration result together with theorem gives the following bound the number adversarial pows: theorem for any noisy quantum storage adversary anoisy with probability exp(- (+) (+) cpq and for any holds that: zanoisy (s) for any consecutive rounds against any noisy quantum storage adversary, with probability exp(-g ()cpq s), long as: and for any consecutive rounds against any noisy quantum storage adversary, with probability exp(-g ()cpq s). corollary under the above restrictions the probability under which the common prefix and chain quality are satisfied becomes: pnoisy exp(-g () where () () (.) non-adaptive adversaries the most general adversaries consider (see next section) allow for the adversary decide how many queries uses trying break one particular pow depending how successful was his previous attempts break pow (previous quantum searches). this "adaptivity" makes the analysis considerably more complicated. much simpler scenario, which call "non-adaptive", occurs when the adversary does not take into account the history successes, meaning that the number queries used before each measurement, are independent the previous measurement outcomes. therefore, can assume that the adversary decides advance how split his total queries, before the rounds start. the bitcoin backbone protocol, the relevant figure that adversary wants optimise the length sequence pows. interestingly, these restricted nonadaptive strategies, can achieve the best (longer) sequences pows average, prove below. this means sufficient complete the analysis. the most general (adaptive) adversaries, while they cannot beat this expectation value, they may able have higher probabilities the "tails" the distributions (see next section) and more generally one cannot use chernoff inequalities bound the general adversary's tails when the variables are dependent. however, given theorem will now focus the non-adaptive case order provide bound the expectation value the most general adversaries. the following sections, will denote this family strategies anonad non-adaptive expectation optimal among all adversaries the total number available queries consider that there are variables corresponding topmeasurements performed the adversary, with queries per measurement where the actual number measurements define let panonad (i) the probability solving pows for non-adaptive adveraries, then the expected number pows can computed as: pkj pkl for while cpq is: max e[zanonad (s)] for any cpq (.) proof. first, let define kmax the number quantum queries required create block with probability one: cpkmax kmax (.) this implies that for each measurement also have kmax then, using eq. (.) get: e[zanonad (s)] kmax cpsq. this concludes the proof that the maximum expected number adversarial blocks, achieved non-adaptive strategies and fact achieved when the adversary spends enough queries per measurement deterministically solve pow. the analysis for non-adaptive adversaries when the total number rounds sufficiently small (less than presented appendix note however, that this case, the number rounds too small and even the honest parties will not produce more than one block, therefore less relevant for the analysis the bitcoin backbone protocol. concentration result non-adaptive adversaries now turn the issue how concentrated around the average value the number actual measured adversarial blocks. for the non-adaptive adversary, have independent search problem after each measurement, which has outcome irrespective how many solutions have been found earlier. can therefore use chernoff bounds approximate the number adversarial blocks using the expectation value: r[zanonad (s) *e[zanonad (s)] (.) unfortunately, only know the maximum value that the expectation can achieve, cannot use directly the chernoff inequality (again using hoeffding inequality would give much weaker bound). instead, need derive our own bound the probability zanonad (s) exceed the value probability which can expressed function (and not e[zanonad (s)]). order use this new derived chernoff type inequality, stated lemma (and proved appendix b), make the following choice variables: (where i-th measurement succeeded, and otherwise), zanonad (s), this gives the following concentration result: ( (.) r[zanonad (s) )e] cpq exp(- (+) and any holds that: (+) zanonad (s) for any consecutive rounds against any non-adaptive adversary, with probability exp(-g () cpqs), long as: and for any consecutive rounds against any non-adaptive adver sary, with probability exp(-g () cpqs). corollary under the above restrictions the probability under which the common prefix and chain quality are satisfied becomes: pnonad pnoisy exp(-g () (.) general adversaries the previous section have examined non-adaptive adversaries, who choose how split the queries for all the next rounds independently from the outcomes measurement. general adversary not this type. instead, general adversary adaptively decides how use the remaining queries depending how successful the previous attempts (to solve pow) were. because theorem know that terms expectation, the non-adaptive adversaries are optimal. however, this does not mean that these adversaries are better always will illustrate with two examples. example imagine scenario that the expected length the honest chain longer than that the adversary. the strategy that maximises the expected length the adversarial chain deterministic, since proven earlier, the adversary runs quantum search until (w.h.p.) certain that will solve the pow. this strategy has zero probability getting more (or less) than the expected number (is very concentrated distribution). therefore obvious that any other strategy (preferably with longer tails), non-adaptive adaptive, that non-deterministic should better. example assume that there non-adaptive strategy aiming generate chain blocks (or more), separating the queries chunks sq/m this strategy will only succeed all searches are successful, meaning that single failed search makes the strategy unsuccessful and the remaining queries wasted. evident that adaptive strategy can better. adversary can start with the same strategy measuring after sq/m queries, long the searches are successful. case one search unsuccessful, any strategy that has one more measurement than the non-adaptive (which now would have failed) would more promising. the point here that both the length but also the shape the tails the distribution can different for, non-optimal terms expectation, adaptive strategies. therefore bound the probabilities the tails the most general (within our security model) adaptive strategy need more careful. will model the corresponding random variables using martingales. unfortunately, the standard concentration results (azuma) for our setting provide very weak bounds the probabilities. this implies that unreasonably long time (number rounds) required achieve given security parameter (when compared with classical noisy-storage non-adaptive analysis). the remaining section will demonstrate this issue, derive some novel concentration inequalities suitable for our purpose and get much improved bounds. will then conclude with the analysis the bitcoin backbone protocol with this concentration result (while use from theorem the bound for the expectation). the following sections, will denote these adversaries agen martingale modelling general adversaries the general strategies scenario, cannot assume the independence the variables corresponding different measurements, and therefore cannot use chernoff inequalities bound the tails the distribution was done the classical, the noisy storage and the non-adaptive cases. bound the observed number adversarial pows using the maximal expectation value need use alternative concentration theorem. will then define the number successful pows martingale. this would then allows get concentration result applying the azumahoeffding inequality. the first step, use the doob martingale construction. start from the sequence random variables {wi where the i-th measurement after using queries was successful and otherwise. consider the total number variables denoting that there are most measurements, and the actual strategy there are less measurements, let's say measurements, then km+ and consequently wm+ seen definition need define function which our case will ..., i.e. the number successful measurements using the chunk splits ..., then, have the following martingale sequence: e[f ..., )|w ..., (.) order apply the azuma inequality (lemma must first upper bound the difference (determine such that): |di |vi vi- e[f ..., e[f ..., wi- noting that e[f ..., )|w ..., ..., e[f ..., (.) get the following concentration result: lemma (concentration from standard azuma). for any general quantum adversary agen and for any have: (.) zagen (s) e[zagen (s)] e[zagen (s)]) have: r[|vn and have: r[zagen (s) e[zagen (s)] kmax (.) proof. for bernoulli variables, the variance bounded the average probability want obtain bound on) the maximum number variables that can have variance greater than therefore implies howk ever, since this quantum strategy also means that for every max variable that belongs the corresponding queries the qro are pleast kmax given that the total number queries the set can have more than kmax elements. using the optimality the non-adaptive strategies with respect the expectation (theorem and their maximum expectation value (theorem leads the following main result regarding general adversaries: theorem given the choice parameters: and kmax where e) exp kmax (.) sketch proof (full proof appendix f). assuming that all parameters are small, eq. (.) becomes: exp which using exp kmax choosing kmax and noting that e) exp (.) kmax r(zagen (s) e[zagen (s)] can see immediately that this much better bound than the ones obtained from lemma and lemma since these lemmas the exponential decay was divided term kmax while here divided kmax other words, this probability becomes negligible the expectation the length the honest parties chain (which exceeds the expectation the adversary's) becomes larger than kmax /p/ while this worse than classical, depending parameters, does not require exceedingly large achieve. the choices the parameters theorem lead bound, that not only much better than the results using azuma inequalities, but also very close the optimal bound obtained with this approach (see appendix g). backbone protocol analysis for general strategies finally, determine the conditions the hashing power the general adversary such that the properties the bitcoin backbone protocol are satisfied. theorem the common prefix property satisfied with parameter for any consecutive rounds against any general adversary, with probability exp(-g () (cp) s), long as: and for any consecutive rounds against any general adversary, with probability exp(-g () (cp) s). corollary under the above restrictions the probability under which the common prefix and chain quality are satisfied becomes: pgen exp () (cp) (.) where () () summary and future directions this section provide comparison between the analysis the bitcoin backbone protocol against classical adversaries and our analysis against the three types quantum adversary (noisy quantum storage, non-adaptive and general). table and the following analysis compare four main aspects: "honest majority" which expresses the relation between the honest hashing power and the (classical quantum) adversary's hashing power. the expected number adversarial blocks within sufficiently large number consecutive rounds. the probability "typical execution," referring the probability that the required bounds the number adversarial queries hold. the number rounds required for each type adversary reach the same level security. honest majority max exp adv. pows aclassical for all lower tail: r[x )u] for all have: r[vn the following hold: |vi vi- have: d+g r[vn then this case, can apply multiplicative chernoff bound (definition and get for any r[x )e[x]] and any have: -ta txi r[x )m )m )m )m )m r[x )m )m and e[x] )m have: zagen (s) e[zagen (s)] )e[zagen (s)]] exp exp e[exp(t (e.) using bennett inequality: random variable, and let e[x] such that: e[(x have: e[e etx [(b b-x et(b-x) r[vn r[vn the concentration result eq. (e.) becomes: r[vn and proof theorem first obtain simpler form for using the inequality: e-x kmax kmax exp (f.) kmax which clearly converges zero the proof concluded noting that max e[z(s)] n/kmax optimality generalised azuma concentration section made certain choices for and got concentration result that (much) better than the earlier attempts using existing concentration results (azuma and stronger version). this appendix give heuristic argument why those choices not only are asymptotically optimal, but also get concentration result that very close the one expect the best (including the constants the exponential decay the expression). will fix kmax the main text (but for now keep a). want find the value that minimises eq. (.) given the minimum allowed eq. (.). once this for any find also the choice that minimises this further (note that the chosen also function g). make heuristic analysis, where using the assumptions that expand the expressions for keeping only the leading terms with respect all the (small) variables. then get: o(higher). and o(higher) also use kmax and since that eq. (.) becomes: -at kmax can approximate (g.) kmax kmax o(higher) kmax the optimal choice for this expression can found approximately: kmax kmax =a* kmax kmax obtain this, dropped higher terms and then fixed all variables except took the derivative the truncated expression w.r.t. and got the above value. therefore know that for this value have the tightest bound irrespective the value the bound becomes: kmax kmax assuming kmax can find the minimum the above expression (taking derivative w.r.t. this time) that occurs for (kmax this means: kmax plugging this value the above expression for gives us: ()/ (kmax kmax other words, the optimal bound could obtained with the following choices: ()/ (g.) worth note, that these choices are extremely close with the ones used our analysis the main paper. far the dependency concerned, for both have the same functional dependency. the constants that actually are required achieve the best bound, depend general. the values chose are close optimal for some choices the final optimal bound with the approximations made (that holds for all the allowed 's), after plugging the expressions for obtained and some more calculations turns out be: exp kmax exp kmax for example, for the choice the above expression gives coefficient which marginally better than the that get with the same from eq. (.). this section demonstrates that our choices (that might have appeared random the main text) not only give good bound that asymptotically the best, but they also give bound that even the constants the exponential decay are close the optimal ones.